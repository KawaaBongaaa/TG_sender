<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, user-scalable=yes, viewport-fit=cover">
    <title>Telegram Sender - –ü–∞–Ω–µ–ª—å —Ä–∞—Å—Å—ã–ª–∫–∏</title>

    <!-- Telegram WebApp SDK -->
    <!-- <script src="https://telegram.org/js/telegram-web-app.js"></script> -->
    <!-- –ó–ê–ö–û–ú–ú–ï–ù–¢–ò–†–û–í–ê–ù–û: –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->

    <!-- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —Å—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="./style-clean.css">
    <link rel="stylesheet" href="./themes.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3Eüì¢%3C/text%3E%3C/svg%3E">



    <!-- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Å–∫—Ä—ã—Ç—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ -->
    <div style="display: none;">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <header class="block-header">
            <h1>–ü–∞–Ω–µ–ª—å —Ä–∞—Å—Å—ã–ª–∫–∏ Telegram</h1>
            <p class="block-subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Å—Å–æ–≤—ã–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –±–æ—Ç–∞</p>
        </header>
        <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
        <div id="loadingScreen" class="loading-screen">
            <div class="loading-spinner"></div>
            <div class="loading-text">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebApp...</div>
        </div>
        <!-- –≠–∫—Ä–∞–Ω –æ—à–∏–±–∫–∏ –¥–æ—Å—Ç—É–ø–∞ -->
        <div id="errorScreen">
            <div class="access-denied-screen">
                <div class="access-denied-icon">üîí</div>
                <h2 class="access-denied-title">–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω</h2>
                <p class="access-denied-text">–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</p>
            </div>
        </div>
        <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
        <div class="app-container">
            <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
            <section class="controls-section">
                <div class="controls-row">
                    <button class="btn btn-primary" id="refreshBtn">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
                    <button class="btn btn-secondary" id="historyBtn">üìö –ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—Å—ã–ª–æ–∫</button>
                </div>
                <!-- –§–∏–ª—å—Ç—Ä—ã -->
                <div class="filters-panel">
                    <div class="filter-group">
                        <label class="filter-label">–°—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</label>
                        <select class="filter-select" id="statusFilterOld">
                            <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                            <option value="active">üü¢ –ê–∫—Ç–∏–≤–Ω—ã–µ</option>
                            <option value="inactive">üü° –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ</option>
                            <option value="kicked">üî¥ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–≤—à–∏–µ –±–æ—Ç–∞</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">–¢—ç–≥</label>
                        <input type="text" class="filter-input" id="tagFilterOld">
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">–ü–æ–∏—Å–∫</label>
                        <input type="text" class="filter-input" id="searchFilterOld">
                    </div>
                    <div class="filter-group">
                        <div class="filter-actions">
                            <button class="btn btn-sm btn-secondary" id="resetFiltersOld">üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
                        </div>
                    </div>
                </div>
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                <div class="controls-row">
                    <div class="status-indicator" id="statusIndicator">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    <div class="status-indicator status-info" id="usersStats">0 –∏–∑ 0 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
            </section>
            <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
            <main class="main-app">
                <!-- –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
                <section class="content-section">
                    <div class="users-table-container">
                        <table class="users-table">
                            <thead>
                                <tr>
                                    <th>ID –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</th>
                                    <th>–ò–º—è / Username</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–¢—ç–≥</th>
                                    <th>–ü–æ—Å–ª–µ–¥–Ω—è—è —Ä–∞—Å—Å—ã–ª–∫–∞</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </section>
            </main>
            <!-- –ü–∞–Ω–µ–ª—å —Ä–∞—Å—Å—ã–ª–∫–∏ -->
            <section class="broadcast-section">
                <button class="broadcast-toggle">–ù–∞—á–∞—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É</button>
                <div class="broadcast-form">
                    <div class="message-input-group">
                        <label class="form-label">–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è</label>
                        <textarea class="message-input" maxlength="4096"></textarea>
                    </div>
                    <div class="buttons-input-group">
                        <label class="form-label">–ö–Ω–æ–ø–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, JSON)</label>
                        <textarea class="buttons-input" rows="3"></textarea>
                    </div>
                    <button class="send-button" disabled>–û—Ç–ø—Ä–∞–≤–∏—Ç—å (0 –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π)</button>
                </div>
                <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä -->
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill"></div>
                    </div>
                    <div class="progress-text">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞...</div>
                </div>
            </section>
            <!-- –†–∞–∑–¥–µ–ª –∏—Å—Ç–æ—Ä–∏–∏ -->
            <section class="history-section"></section>
        </div>
    </div>

    <!-- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è -->
    <script src="./config.js"></script>

    <!-- –ù–û–í–ê–Ø –ö–û–ú–ü–ê–ö–¢–ù–ê–Ø –°–ï–¢–ö–ê –ò–ù–¢–ï–†–§–ï–ô–°–ê -->
    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px; margin: 20px 0;">

        <!-- –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –ë–æ—Ç—ã + –ú–∏–Ω–∏ –º–æ–¥—É–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
        <div style="display: flex; flex-direction: column; gap: 20px;">

            <!-- –°–ï–ö–¶–ò–Ø –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ë–û–¢–ê–ú–ò -->
            <div class="section-blue" style="padding: 15px; border: 2px solid var(--text-accent); border-radius: 10px; background: var(--bg-secondary);">
                <h3 style="margin: 0 0 12px 0; color: var(--text-accent);">ü§ñ –ë–æ—Ç—ã</h3>

                <div style="margin-bottom: 8px;">
                    <select id="botsList" style="width: 100%; margin: 3px 0; padding: 6px;">
                        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –±–æ—Ç–∞ --</option>
                    </select>
                </div>

                <div style="margin-bottom: 8px;">
                    <select id="sheetsList" style="width: 100%; margin: 3px 0; padding: 6px;">
                        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É --</option>
                    </select>
                </div>

                <div style="display: flex; gap: 5px;">
                    <button id="loadUsersBtn" style="flex: 1; padding: 6px; background: var(--accent-info); color: var(--text-inverse); border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;">üì• –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</button>
                    <button id="editBotsBtn" style="flex: 1; padding: 6px; background: var(--accent-primary); color: var(--text-inverse); border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">‚öôÔ∏è</button>
                    <button id="editSheetsBtn" style="flex: 1; padding: 6px; background: var(--accent-warning); color: var(--text-inverse); border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">üìä</button>
                </div>

                <div id="currentBotInfo" style="margin-top: 10px; padding: 5px; background: var(--bg-tertiary); border-radius: 5px; font-size: 11px; color: var(--text-primary); border: 1px solid var(--border);">
                    –ù–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –±–æ—Ç–∞
                </div>
            </div>

            <!-- –û–ë–™–ï–î–ò–ù–ï–ù–ù–´–ô –ö–û–ú–ü–ê–ö–¢–ù–´–ô –ú–û–î–£–õ–¨ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô -->
            <div class="section-accent" style="padding: 15px; border: 2px solid var(--accent-primary); border-radius: 10px; background: var(--accent-bg);">
                <h3 style="margin: 0 0 12px 0; color: var(--accent-primary);">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ + —Ñ–∏–ª—å—Ç—Ä—ã</h3>

                <!-- –ö–ù–û–ü–ö–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –°–õ–ï–í–ê -->
                <div style="display: flex; gap: 5px; margin-bottom: 8px;">
                    <button id="selectAllUsersBtn" style="flex: 1; padding: 4px; font-size: 11px; background: var(--accent-primary); color: var(--text-inverse); border: none; border-radius: 4px; cursor: pointer;">‚úÖ –í—Å–µ</button>
                    <button id="clearUsersSelectionBtn" style="flex: 1; padding: 4px; font-size: 11px; background: var(--accent-error); color: var(--text-inverse); border: none; border-radius: 4px; cursor: pointer;">‚ùå –°–Ω—è—Ç—å</button>
                </div>



                <!-- –¢–ê–ë–´: –í—Å–µ / –°–ø–∏—Å–∫–∏ -->
                <div style="display: flex; gap: 2px; margin-bottom: 8px; background: var(--bg-secondary); border-radius: 4px; padding: 2px;">
                    <button id="usersTabAll" style="flex: 1; padding: 6px; font-size: 11px; background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 3px; cursor: pointer;" onclick="showUsersTab('all')">–í—Å–µ</button>
                    <button id="usersTabLists" style="flex: 1; padding: 6px; font-size: 11px; background: var(--bg-tertiary); color: var(--text-secondary); border: 1px solid transparent; border-radius: 3px; cursor: pointer;" onclick="showUsersTab('lists')">–°–ø–∏—Å–∫–∏</button>
                </div>

                <!-- –ö–û–ù–¢–ï–ù–¢ –í–ö–õ–ê–î–û–ö -->
                <div id="usersTabContent">
                    <!-- –§–ò–õ–¨–¢–†–´ (–ê–ö–¢–ò–í–ù–ê–Ø –í–ö–õ–ê–î–ö–ê) -->
                    <div id="usersFiltersTab" style="display: block;">
                        <h4 style="margin: 8px 0 6px 0; font-size: 12px; color: var(--accent-primary);">üîç –§–∏–ª—å—Ç—Ä—ã:</h4>

                        <div style="margin-bottom: 6px;">
                            <input id="searchFilter" placeholder="–ü–æ–∏—Å–∫..." style="width: 100%; padding: 4px; font-size: 11px; background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border);">
                        </div>

                        <div style="display: flex; gap: 2px; margin-bottom: 6px;">
                        </div>

                        <div style="display: flex; flex-wrap: wrap; gap: 1px; margin-bottom: 6px;">
                            <label style="font-size: 10px;"><input type="checkbox" id="statusTrial" style="transform: scale(0.8);"> trial</label>
                            <label style="font-size: 10px;"><input type="checkbox" id="statusNewSub" style="transform: scale(0.8);"> new_sub</label>
                            <label style="font-size: 10px;"><input type="checkbox" id="statusCanceled" style="transform: scale(0.8);"> canceled</label>
                            <label style="font-size: 10px;"><input type="checkbox" id="statusKicked" style="transform: scale(0.8);"> kicked</label>
                        </div>

                        <div style="display: flex; flex-wrap: wrap; gap: 1px; margin-bottom: 6px;">
                            <h5 style="margin: 8px 0 4px 0; font-size: 11px; color: var(--accent-primary); width: 100%;">üåç –Ø–∑—ã–∫–∏:</h5>
                            <label style="font-size: 9px;"><input type="checkbox" id="languageRu" style="transform: scale(0.8);"> RU</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="languageEn" style="transform: scale(0.8);"> EN</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="languageEs" style="transform: scale(0.8);"> ES</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="languageFr" style="transform: scale(0.8);"> FR</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="languageDe" style="transform: scale(0.8);"> DE</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="languageIt" style="transform: scale(0.8);"> IT</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="languagePt" style="transform: scale(0.8);"> PT</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="languageZh" style="transform: scale(0.8);"> ZH</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="languageAr" style="transform: scale(0.8);"> AR</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="languageJa" style="transform: scale(0.8);"> JA</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="languagePl" style="transform: scale(0.8);"> PL</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="languageTr" style="transform: scale(0.8);"> TR</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="languageKo" style="transform: scale(0.8);"> KO</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="languageHi" style="transform: scale(0.8);"> HI</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="languageFa" style="transform: scale(0.8);"> FA</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="languageOther" style="transform: scale(0.8);"> Other</label>
                        </div>

                        <div style="margin-bottom: 6px;">
                            <label style="font-size: 10px; color: var(--text-secondary);">–î—Ä—É–≥–æ–π —è–∑—ã–∫:</label>
                            <input id="customLanguageFilter" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: uk, pl, ko" style="width: 100%; padding: 2px; font-size: 10px; background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border);">
                        </div>

                        <div style="display: flex; flex-wrap: wrap; gap: 1px; margin-bottom: 6px;">
                            <h5 style="margin: 8px 0 4px 0; font-size: 11px; color: var(--accent-primary); width: 100%;">üé® Trial Calls:</h5>
                            <label style="font-size: 9px;"><input type="checkbox" id="trialCallsLess0" style="transform: scale(0.8);"> <0</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="trialCallsLess5" style="transform: scale(0.8);"> <5</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="trialCallsMid" style="transform: scale(0.8);"> 0-20</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="trialCallsGreater20" style="transform: scale(0.8);"> >20</label>
                            <label style="font-size: 9px;"><input type="checkbox" id="trialCallsEquals20" style="transform: scale(0.8);"> =20</label>
                        </div>

                        <div style="display: flex; gap: 1px;">
                            <button id="selectAllStatuses" style="flex: 1; padding: 3px; font-size: 10px; background: var(--accent-secondary); color: var(--text-inverse); border: none; border-radius: 2px; cursor: pointer;">–í—Å–µ</button>
                            <button id="resetFilters" style="flex: 1; padding: 3px; font-size: 10px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 2px; cursor: pointer;">–°–±—Ä–æ—Å</button>
                        </div>
                    </div>

                    <!-- –°–ü–ò–°–ö–ò –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô -->
                    <div id="usersListsTab" style="display: none;">
                        <h4 style="margin: 8px 0 6px 0; font-size: 12px; color: var(--accent-primary);">üìã –°–ø–∏—Å–∫–∏:</h4>
                        <div id="userListsContainerCompact" style="max-height: 120px; overflow-y: auto;">
                            –ó–∞–≥—Ä—É–∑–∫–∞...
                        </div>
                        <div style="display: flex; gap: 2px; margin-top: 6px;">
                            <button id="saveToListBtn" style="flex: 1; padding: 4px; font-size: 10px; background: var(--accent-primary); color: var(--text-inverse); border: none; border-radius: 3px; cursor: pointer;">üíæ</button>
                            <button id="manageListsBtn" style="flex: 1; padding: 4px; font-size: 10px; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 3px; cursor: pointer;">‚öôÔ∏è</button>
                        </div>
                    </div>
                </div>

                <!-- –ú–ò–ù–ò-–¢–ê–ë–õ–ò–¶–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô -->
                <div style="margin-top: 8px; border-top: 1px solid var(--border); padding-top: 6px;">
                    <h4 style="margin: 6px 0 8px 0; font-size: 12px; color: var(--accent-primary);">üìã –í—ã–±—Ä–∞–Ω–Ω—ã–µ:</h4>
                    <div id="selectedUsersMiniList" style="max-height: 100px; overflow-y: auto; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 4px; padding: 4px;">
                        <div style="color: var(--text-secondary); font-size: 11px;">–ù–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                    </div>
                    <button onclick="expandUsersTable()" style="width: 100%; margin-top: 6px; padding: 4px; font-size: 11px; background: var(--text-accent); color: var(--text-inverse); border: none; border-radius: 3px; cursor: pointer;">üîç –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Ç–∞–±–ª–∏—Ü—É</button>
                </div>
            </div>

        </div>

        <!-- –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å —Å–æ–æ–±—â–µ–Ω–∏–π -->
        <div>

            <!-- –û–ë–™–ï–î–ò–ù–ï–ù–ù–´–ô –ú–û–î–£–õ–¨ –°–û–û–ë–©–ï–ù–ò–ô, –®–ê–ë–õ–û–ù–û–í –ò –ü–õ–ê–ù–ò–†–û–í–©–ò–ö–ê -->
            <div class="section-green" style="padding: 15px; border: 2px solid var(--accent-success); border-radius: 10px; background: var(--success-bg);">
                <h3 style="margin: 0 0 12px 0; color: var(--accent-success);">‚úâÔ∏è –°–æ–æ–±—â–µ–Ω–∏—è, —à–∞–±–ª–æ–Ω—ã –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</h3>

                <!-- –ù–ê–ó–í–ê–ù–ò–ï –†–ê–°–°–´–õ–ö–ò -->
                <div style="margin-bottom: 15px; padding-bottom: 12px; border-bottom: var(--border);">
                    <h4 style="margin: 0 0 8px 0; font-size: 13px; color: var(--accent-success);">üì¢ –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞—Å—Å—ã–ª–∫–∏</h4>
                    <div style="display: flex; gap: 4px; margin-bottom: 4px;">
                        <input type="text" id="broadcastNameInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ê–∫—Ü–∏—è –ù–æ–≤—ã–π –ì–æ–¥" style="flex: 1; padding: 4px; font-size: 11px; background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border);">
                        <button id="saveBroadcastTemplateBtn" style="padding: 4px 8px; font-size: 11px; background: var(--accent-secondary); color: var(--text-inverse); border: none; border-radius: 3px; cursor: pointer;">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ —à–∞–±–ª–æ–Ω</button>
                    </div>
                    <select id="broadcastTemplateSelect" style="width: 100%; padding: 4px; font-size: 11px; background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border);">
                        <option value="">-- –í—ã–±—Ä–∞—Ç—å —à–∞–±–ª–æ–Ω —Ä–∞—Å—Å—ã–ª–∫–∏ --</option>
                    </select>
                </div>

                <!-- –¢–ï–ö–°–¢ –°–û–û–ë–©–ï–ù–ò–Ø -->
                <div style="margin-bottom: 15px; padding-bottom: 12px; border-bottom: var(--border);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <h4 style="margin: 0; font-size: 13px; color: var(--accent-success);">üìù –°–æ–æ–±—â–µ–Ω–∏–µ</h4>
                        <button id="insertLinkBtn" style="padding: 3px 8px; font-size: 11px; background: var(--text-accent); color: var(--text-inverse); border: none; border-radius: 4px; cursor: pointer;">üîó –°—Å—ã–ª–∫–∞</button>
                    </div>
                    <textarea id="messageInput" rows="3" placeholder="–¢–µ–∫—Å—Ç –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏..." style="width: 100%; resize: vertical; min-height: 70px; background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border);"></textarea>
                </div>

                <!-- INLINE –ö–ù–û–ü–ö–ò –ò –ú–ï–î–ò–ê -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; padding-bottom: 12px; border-bottom: var(--border);">
                    <div>
                        <h4 style="margin: 0 0 8px 0; font-size: 13px; color: var(--accent-success);">üîò –ö–Ω–æ–ø–∫–∏</h4>
                        <div style="display: flex; gap: 4px; margin-bottom: 4px;">
                            <input type="text" id="newButtonText" placeholder="–¢–µ–∫—Å—Ç" style="flex: 1; padding: 4px; font-size: 11px; background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border);">
                            <input type="text" id="newButtonUrl" placeholder="URL" style="flex: 1; padding: 4px; font-size: 11px;">
                        </div>
                        <button id="addButton" style="width: 100%; padding: 4px; font-size: 11px; background: var(--accent-success); color: var(--text-inverse); border: none; border-radius: 3px; cursor: pointer;">‚ûï –ö–Ω–æ–ø–∫–∞</button>
                        <div id="buttonsList" style="margin-top: 4px; max-height: 60px; overflow-y: auto;"></div>
                        <button id="clearButtons" style="width: 100%; margin-top: 4px; padding: 3px; font-size: 10px; background: var(--accent-error); color: var(--text-inverse); border: none; border-radius: 2px; cursor: pointer;">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                    </div>

                    <div>
                        <h4 style="margin: 0 0 8px 0; font-size: 13px; color: var(--accent-success);">üìé –ú–µ–¥–∏–∞</h4>
                        <input type="file" id="mediaFileInput" accept="image/*,video/*,audio/*,application/*" style="width: 100%; padding: 4px; font-size: 11px; background: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border); border-radius: 3px;">
                        <select id="mediaTypeSelect" style="width: 100%; margin: 4px 0; padding: 4px; font-size: 11px;">
                            <option value="auto">–ê–≤—Ç–æ</option>
                            <option value="photo">–§–æ—Ç–æ</option>
                            <option value="video">–í–∏–¥–µ–æ</option>
                            <option value="audio">–ê—É–¥–∏–æ</option>
                            <option value="document">–î–æ–∫—É–º–µ–Ω—Ç</option>
                        </select>
                        <button id="clearMediaBtn" style="width: 100%; padding: 3px; font-size: 10px; background: var(--accent-error); color: var(--text-inverse); border: none; border-radius: 2px; cursor: pointer;">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                        <div id="mediaPreview" style="margin-top: 4px; padding: 4px; background: var(--bg-secondary); border-radius: 3px; display: none;"></div>
                    </div>
                </div>

                <!-- –®–ê–ë–õ–û–ù–´ –ò –ü–õ–ê–ù–ò–†–û–í–©–ò–ö -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; padding-bottom: 12px; border-bottom: var(--border);">
                    <div>
                        <h4 style="margin: 0 0 8px 0; font-size: 13px; color: var(--accent-success);">üìã –®–∞–±–ª–æ–Ω—ã</h4>
                        <select id="templateSelect" style="width: 100%; padding: 4px; font-size: 11px;">
                            <option value="">-- –í—ã–±—Ä–∞—Ç—å --</option>
                        </select>
                        <button id="editTemplatesBtn" style="width: 100%; margin-top: 4px; padding: 4px; font-size: 11px; background: var(--accent-secondary); color: var(--text-inverse); border: none; border-radius: 3px; cursor: pointer;">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞</button>
                    </div>

                    <div>
                        <h4 style="margin: 0 0 8px 0; font-size: 13px; color: var(--accent-success);">‚è∞ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</h4>
                        <input type="datetime-local" id="scheduleDateTime" style="width: 100%; padding: 4px; font-size: 11px;">
                        <input type="number" id="messageTimeoutInput" value="1000" min="0" max="30000" step="500" style="width: 100%; margin: 4px 0; padding: 4px; font-size: 11px;">
                        <div style="display: flex; gap: 2px;">
                            <button id="scheduleBroadcastBtn" style="flex: 1; padding: 3px; font-size: 10px;">üìÖ</button>
                            <button id="cancelScheduleBtn" style="flex: 1; padding: 3px; font-size: 10px; background: #dc3545;">‚ùå</button>
                        </div>
                    </div>
                </div>

                <!-- –ü–†–û–ì–†–ï–°–°-–ë–ê–† –î–õ–Ø –†–ê–°–°–´–õ–û–ö -->
                <div id="progressContainer" class="progress-container" style="display: none;">
                    <div id="progressBar" class="progress-bar"></div>
                    <div id="progressText" class="progress-text">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>

                <!-- –ö–ù–û–ü–ö–ò –î–ï–ô–°–¢–í–ò–ô -->
                <div style="display: flex; gap: 8px;">
                    <button id="sendBtn" style="flex: 1; padding: 8px; background: var(--accent-destructive); color: var(--text-inverse); border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                        üì§ –¢–µ—Å—Ç
                    </button>
                    <button id="sendMassBtn" style="flex: 1; padding: 8px; background: var(--accent-primary); color: var(--text-inverse); border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                        üì¢ –†–∞—Å—Å—ã–ª–∫–∞
                    </button>
                </div>
            </div>

        </div>

    </div>

    <!-- –†–ê–°–®–ò–†–ï–ù–ù–ê–Ø –ü–û–õ–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô (–°–ö–†–´–¢–ê –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ) -->
    <div id="expandedUsersTable" style="margin: 20px 0; display: none;">
        <div style="background: var(--bg-secondary); padding: 12px; border: 2px solid var(--accent-primary); border-radius: 10px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <h3 style="margin: 0; color: var(--accent-primary);">üë• –ü–æ–ª–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                <button onclick="collapseUsersTable()" style="padding: 6px 12px; background: var(--accent-error); color: var(--text-inverse); border: none; border-radius: 6px; cursor: pointer;">‚úñ –°–≤–µ—Ä–Ω—É—Ç—å</button>
            </div>

            <div style="max-height: 400px; overflow: auto; border: 1px solid var(--border); border-radius: 8px; background: white;">
                <table id="usersTable" style="width: 100%; border-collapse: collapse; font-size: 12px;">
                    <thead>
                        <tr style="background: var(--bg-secondary); position: sticky; top: 0; z-index: 1;">
                            <th style="border-bottom: 2px solid var(--border); padding: 8px 4px; text-align: left; width: 30px;">
                                <input type="checkbox" id="masterUserCheckbox" style="transform: scale(1.1);">
                            </th>
                            <th style="border-bottom: 2px solid var(--border); padding: 8px 4px;" class="sortable" data-sort="user_id">üÜî ID</th>
                            <th style="border-bottom: 2px solid var(--border); padding: 8px 4px;" class="sortable" data-sort="first_name">üë§ –ò–º—è</th>
                            <th style="border-bottom: 2px solid var(--border); padding: 8px 4px;" class="sortable" data-sort="last_name">üë§ –§–∞–º–∏–ª–∏—è</th>
                            <th style="border-bottom: 2px solid var(--border); padding: 8px 4px;" class="sortable" data-sort="username">üë• Username</th>
                            <th style="border-bottom: 2px solid var(--border); padding: 8px 4px;" class="sortable" data-sort="status">üìä –°—Ç–∞—Ç—É—Å</th>
                            <th style="border-bottom: 2px solid var(--border); padding: 8px 4px;" class="sortable" data-sort="language">üåç –Ø–∑—ã–∫</th>
                            <th style="border-bottom: 2px solid var(--border); padding: 8px 4px;" class="sortable" data-sort="premium">‚≠ê –ü—Ä–µ–º–∏—É–º</th>
                            <th style="border-bottom: 2px solid var(--border); padding: 8px 4px;" class="sortable" data-sort="traffic_from">üö¶ –ò—Å—Ç–æ—á–Ω–∏–∫</th>
                            <th style="border-bottom: 2px solid var(--border); padding: 8px 4px;" class="sortable" data-sort="trial_img_gen_calls">üé® Triall Calls</th>
                            <th style="border-bottom: 2px solid var(--border); padding: 8px 4px;" class="sortable" data-sort="last_sent">üìÖ –ü–æ—Å–ª–µ–¥–Ω—è—è –æ—Ç–ø—Ä–∞–≤–∫–∞</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody">
                        <tr>
                            <td colspan="11" style="text-align: center; padding: 40px; color: #6c757d;">
                                üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="logContainer" style="margin: 20px 0; background: #f8f9fa; padding: 10px; max-height: 200px; overflow-y: auto; font-size: 12px; color: #333; border: 1px solid #dee2e6; border-radius: 4px;">
        <strong>–õ–æ–≥ –¥–µ–π—Å—Ç–≤–∏–π:</strong><br>
    </div>

    <!-- –í–°–ü–õ–´–í–ê–Æ–©–ò–ï –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê -->

    <!-- –§–û–†–ú–ê –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ë–û–¢–ê–ú–ò (–°–ö–†–´–¢–ê) -->
    <!-- –°–ï–ö–¶–ò–Ø –ü–õ–ê–ù–ò–†–û–í–©–ò–ö–ê (–ü–ï–†–ï–ú–ï–©–ï–ù–ê –í –û–°–ù–û–í–ù–û–ô –ú–û–î–£–õ–¨) -->
    <!-- –°–ï–ö–¶–ò–Ø –°–ü–ò–°–ö–û–í –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô (–ò–ù–¢–ï–ì–†–ò–†–û–í–ê–ù–ê) -->
    <!-- –°–ï–ö–¶–ò–Ø –§–ò–õ–¨–¢–†–û–í (–ò–ù–¢–ï–ì–†–ò–†–û–í–ê–ù–ê) -->
    <!-- –û–ë–™–ï–î–ò–ù–ï–ù–ù–´–ô –ú–û–î–£–õ–¨ –°–û–û–ë–©–ï–ù–ò–ô –ò –®–ê–ë–õ–û–ù–û–í (–ü–ï–†–ï–î–ï–õ–ê–ù) -->

    <!-- –ú–æ–¥—É–ª–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <script src="./telegram-storage.js"></script>
    <script src="./telegram-messaging-advanced.js"></script>
    <script src="./telegram-users-advanced.js"></script>
    <script src="./telegram-userlists.js"></script>
    <script src="./telegram-bots.js"></script>
    <script src="./telegram-links.js"></script>
    <script src="./telegram-buttons.js"></script>
    <script src="./telegram-settings.js"></script>
    <script src="./telegram-notifications.js"></script>

    <!-- –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º
        const themeButtons = document.querySelectorAll('.theme-btn');

        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã
        function applyTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('telegramSenderTheme', theme);

            // –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
            themeButtons.forEach(btn => {
                if(btn.dataset.theme === theme) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });

            // –ê–Ω–∏–º–∞—Ü–∏—è –ª–æ–≥–æ—Ç–∏–ø–∞
            const logo = document.querySelector('h1');
            if(logo) {
                logo.style.animation = 'none';
                logo.offsetHeight; // trigger reflow
                logo.style.animation = 'fadeIn 0.3s ease-out';
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤ –ø–æ –∫–Ω–æ–ø–∫–∞–º —Ç–µ–º
        themeButtons.forEach(button => {
            button.addEventListener('click', function() {
                const theme = this.dataset.theme;
                applyTheme(theme);

                if(window.telegramSender && window.telegramSender.addToLog) {
                    window.telegramSender.addToLog(`–¢–µ–º–∞ –∏–∑–º–µ–Ω–µ–Ω–∞ –Ω–∞ ${theme}`);
                }
            });
        });

        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é —Ç–µ–º—É
        const savedTheme = localStorage.getItem('telegramSenderTheme') || 'light';
        applyTheme(savedTheme);
    });

    // –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ê–ë–û–¢–´ –° –ö–û–ú–ü–ê–ö–¢–ù–´–ú –ò–ù–¢–ï–†–§–ï–ô–°–û–ú
    function showUsersTab(tab) {
        const filtersTab = document.getElementById('usersFiltersTab');
        const listsTab = document.getElementById('usersListsTab');
        const tabAll = document.getElementById('usersTabAll');
        const tabLists = document.getElementById('usersTabLists');

        if (tab === 'all') {
            filtersTab.style.display = 'block';
            listsTab.style.display = 'none';
            tabAll.style.background = 'var(--bg-primary)';
            tabAll.style.color = 'var(--text-primary)';
            tabAll.style.border = '1px solid var(--border)';
            tabLists.style.background = 'var(--bg-tertiary)';
            tabLists.style.color = 'var(--text-secondary)';
            tabLists.style.border = '1px solid transparent';
        } else {
            filtersTab.style.display = 'none';
            listsTab.style.display = 'block';
            tabLists.style.background = 'var(--bg-primary)';
            tabLists.style.color = 'var(--text-primary)';
            tabLists.style.border = '1px solid var(--border)';
            tabAll.style.background = 'var(--bg-tertiary)';
            tabAll.style.color = 'var(--text-secondary)';
            tabAll.style.border = '1px solid transparent';
        }
    }

    function expandUsersTable() {
        document.getElementById('expandedUsersTable').style.display = 'block';
        document.getElementById('expandedUsersTable').scrollIntoView({ behavior: 'smooth' });
    }

    function collapseUsersTable() {
        document.getElementById('expandedUsersTable').style.display = 'none';
    }

    // –î–û–ë–ê–í–õ–Ø–ï–ú –§–£–ù–ö–¶–ò–ò –í –ì–õ–û–ë–ê–õ–¨–ù–£–Æ –û–ë–õ–ê–°–¢–¨
    window.showUsersTab = showUsersTab;
    window.expandUsersTable = expandUsersTable;
    window.collapseUsersTable = collapseUsersTable;

    // –§–£–ù–ö–¶–ò–ò –î–õ–Ø –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ë–û–¢–ê–ú–ò –í –õ–ò–°–¢–ï
    function selectBotFromList(botId) {
        if (window.telegramSender?.modules?.bots) {
            window.telegramSender.modules.bots.selectBot(botId);
            window.telegramSender.closeAllModals();
        }
    }

    function deleteBotFromList(botId) {
        if (window.telegramSender?.modules?.bots) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –±–æ—Ç–∞ –∏ –≤—Å–µ –µ–≥–æ —Ç–∞–±–ª–∏—Ü—ã?')) {
                window.telegramSender.modules.bots.deleteBot(botId);
                // updateBotListContainer —É–∂–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ deleteBot() –º–µ—Ç–æ–¥–µ
            }
        }
    }
    </script>

    <script src="./app.js"></script>
</body>

</html>
